<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Resize Calculator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 2rem;
    }
    input[type="number"], input[type="file"] {
      margin-bottom: 1rem;
      display: block;
    }
    #output {
      margin-top: 1rem;
      white-space: pre-wrap;
      background: #f0f0f0;
      padding: 1rem;
      border-radius: 8px;
    }
  </style>
</head>
<body>

<h2>Resize Width Calculator</h2>
<input type="file" id="fileInput" multiple>
<input type="number" id="finalWidth" placeholder="Enter final width">
<button onclick="calculate()">Calculate</button>

<div id="output"></div>

<script>
    function calculate() {
      const files = document.getElementById('fileInput').files;
      const finalWidth = parseFloat(document.getElementById('finalWidth').value);
      const outputDiv = document.getElementById('output');
    
      if (!files.length || isNaN(finalWidth)) {
        outputDiv.textContent = "Please select image files and enter a valid final width.";
        return;
      }
    
      const widths = [];
    
      const loadImageWidth = (file) => {
        return new Promise((resolve) => {
          const img = new Image();
          const url = URL.createObjectURL(file);
    
          img.onload = () => {
            const width = img.naturalWidth;
            if (!widths.includes(width)) {
              widths.push(width);
            }
            URL.revokeObjectURL(url);
            resolve();
          };
    
          img.onerror = () => {
            URL.revokeObjectURL(url);
            resolve(); // Skip broken image
          };
    
          img.src = url;
        });
      };
    
      const promises = Array.from(files).map(loadImageWidth);
    
      Promise.all(promises).then(() => {
        if (widths.length === 0) {
          outputDiv.textContent = "No valid image dimensions found.";
          return;
        }
    
        const total = widths.reduce((a, b) => a + b, 0);
        const resized = widths.map(w => +(w / total * finalWidth).toFixed(0));
    
        outputDiv.textContent = resized.join('\n');
      });
    }
    </script>

</body>
</html>